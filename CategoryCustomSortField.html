<div class="CustomSortingField">
	<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
	<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

    <div id="category-sort" class="desktop">
        <h4>Filter these products <i id="collapse-status" class="fa fa-chevron-up"></i></h4>
        
        <div id="category-sort-content">
        
            <form id="category-sort-form">
                <input name="id" type="hidden" value="" />
                <input name="budget_start" type="hidden" value="50" />
                <input name="budget_end" type="hidden" value="300" />
                <input name="height_start" type="hidden" value="0" />
                <input name="height_end" type="hidden" value="28" />
                
                <div class="six columns">
                    <p><label>Budget: <span id="budget-span"></span></label></p>
                    <div id="budget-range"></div>
                </div>
<!--
                <div class="six columns alpha omega offset-by-one">
                    <p><label>Height: <span id="height-span"></span></label></p>
                    <div id="height-range"></div>
                </div>
                
                <div class="clear"></div>
                
                <div class="six columns">
                    <p><label>Joint Size:</label></p>
                    <div class="sort-button"><input type="checkbox" name="jointsizes[]" value="10mm" checked="checked">10mm</div>
                    <div class="sort-button"><input type="checkbox" name="jointsizes[]" value="14.5mm" checked="checked">14.5mm</div>
                    <div class="sort-button"><input type="checkbox" name="jointsizes[]" value="18.8mm" checked="checked">18.8mm</div>
                </div>
                <div class="six columns alpha omega offset-by-one">
                    <p><label>Joint Gender:</label></p>
                    <div class="sort-button"><input type="checkbox" name="jointgenders[]" value="male" checked="checked">Male Joint</div>
                    <div class="sort-button"><input type="checkbox" name="jointgenders[]" value="female" checked="checked">Female Joint</div>
                    <div class="sort-button"><input type="checkbox" name="jointgenders[]" value="na" checked="checked">Not Available</div>
                </div>
                
                <div class="clear"></div>
                
                <div class="category-sort-foot">
                <input id="sort-submit" type="submit" value="Filter Products" class="btn" />
                <input type="checkbox" name="hidesoldout" id="hidesoldout" >Hide Sold Out Products
                </div>
-->
                </form>
            
            <div class="clear"></div>
        </div>
    </div>


    <script type="text/javascript">
    $(function() {

        function sliderstop() {
/*
		            function setHeight(ele) {
				var ele = $(ele),
					maxHeight = 0;
				ele
					// reset the height just in case it was set by the stylesheet so
					// we can detect it
					.css('min-height', 'auto')
					// get the one with the greatest height
					.each(function() {
						if ($(this).height() > maxHeight) {
							maxHeight = $(this).height();
						}
					})
					// and set them all to the greatest height
					.css('min-height', maxHeight);
			}
*/
            $('#AjaxLoading').hide();
        }
        
        function sliderstart() {
            /*
            currentproducts = $('#products').children('.item:visible');
            products.find('br.clear').remove();
            products.children('.item').removeClass('alpha').removeClass('omega');
            
            height_vals = $("#height-range").slider('values');
            budget_vals = $("#budget-range").slider('values');

            jointsize_vals = [];
            $('#jointsizes input').each(function() {
                if($(this).is(":checked")) {
                    jointsize_vals.push($(this).val());
                }
            });
            
            jointgender_vals = [];
            $('#jointgenders input').each(function() {
                if($(this).is(":checked")) {
                    jointgender_vals.push($(this).val());
                }
            });
            */
                    
            $('#AjaxLoading').show();
        }
        
        function hidesoldout() {
            $('ul.ProductList').find('.SoldOut').hide();
            sliderstop();
        }
        
        function showsoldout() {
            $('ul.ProductList').find('.SoldOut').show();
            sliderstop();
        }
        
        function filterByPrice() {
	        var $productItems = $('ul.ProductList > li');
	        $productItems.each(function() {
		        var $this = $(this);
		        console.log($this);
				var $productPrice = parseInt($this.find('.p-price:not("strike")').text().replace(/[^\d\.]/g, ''));
		        console.log($productPrice);
		        var $lowPrice = $("#category-sort-form input[name='budget_start']").val();
		        var $highPrice = $("#category-sort-form input[name='budget_end']").val();
		        if (($productPrice < $lowPrice) && ($productPrice > $highPrice)) {
			        console.log('condition met!');
			        $this.fadeOut();
		        } else {
			        console.log('condition met!');
			        $this.fadeIn();
		        }
	        });
        }

		var budgetslider = $( "#budget-range" ).slider({
          range: true,
          min: 0,
          max: 900,
          values: [ 80, 500 ],
          slide: function( event, ui ) {
            $( "#budget-span" ).text( "Between $" + ui.values[ 0 ] + " - $" + ui.values[ 1 ] );
          },
          stop: function( event, ui ) {
            $("#category-sort-form input[name='budget_start']").val(ui.values[ 0 ]);
            $("#category-sort-form input[name='budget_end']").val(ui.values[ 1 ]);
            filterByPrice();
          }
        });
        $( "#budget-span" ).text( "Between $" + $( "#budget-range" ).slider( "values", 0 ) + " - $" + $( "#budget-range" ).slider( "values", 1 ) );
        
        $('#category-sort h4').click(function() {        
            $('#category-sort-content').toggle(); 
            
            if($('#category-sort-content').is(":visible")) {
                $(this).find('i').attr('class', 'fa fa-chevron-up');
                //$.cookie('show_sort', 'yes');
            }
            else {
                $(this).find('i').attr('class', 'fa fa-chevron-down');
                //$.cookie('show_sort', 'no');
            }

/*
            if($(this).find('i').hasClass('icon-down-open')) {
                $(this).find('i').attr('class', 'icon-up-open');
            }
            else {
                $(this).find('i').attr('class', 'icon-down-open');
            }     
*/
        });
                
        $('#hidesoldout').change(function() {
            if($(this).is(":checked")) {
                //$.cookie('show_soldout', 'no');
                hidesoldout();
            }
            else {
                //$.cookie('show_soldout', 'yes');
                showsoldout();
            }
        });
        

/*
        $( "#budget-span" ).text( "Between $" + $( "#budget-range" ).slider( "values", 0 ) + " - $" + $( "#budget-range" ).slider( "values", 1 ) );        
        $( "#height-span" ).text( "Between " + $( "#height-range" ).slider( "values", 0 ) + " inches - " + $( "#height-range" ).slider( "values", 1 ) + ' inches tall');
*/
        
    });
    </script>

    
    
</div>